/* eslint-disable react-hooks/exhaustive-deps */
import { useRef, useEffect, useState } from "react";

const Demo = () => {
  const container = useRef(null);
  const sentinels = useRef([]);
  const [activeItem, setActiveItem] = useState(null);

  // Dữ liệu các item
  const items = [
    {
      id: "item1",
      content:
        "Nội dung cho item 1   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  ",
    },
    {
      id: "item2",
      content:
        "Nội dung cho item 2   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em ",
    },
    {
      id: "item3",
      content:
        "Nội dung cho item 3   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em   Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatem odit molestias, ratione hic voluptas iure alias nulla saepe ducimus tenetur ut id ipsum veniam eos! Non magnam magni perferendis commodi? Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptat em  ",
    },
  ];

  // Hàm xử lý cuộn
  const handleScroll = () => {
    const containerRect = container.current.getBoundingClientRect();
    const offset = containerRect.top;
    sentinels.current.forEach((sentinel) => {
      const sentinelRect = sentinel.getBoundingClientRect();
      if (sentinelRect.top < offset && sentinelRect.bottom > offset) {
        setActiveItem(sentinel.id);
      }
    });
  };

  useEffect(() => {
    // Lưu các phần tử vào sentinels
    sentinels.current = items.map((item) => document.getElementById(item.id));

    // Thêm sự kiện cuộn cho container
    const currentContainer = container.current;
    currentContainer.addEventListener("scroll", handleScroll);

    // Cleanup event listener
    return () => {
      currentContainer.removeEventListener("scroll", handleScroll);
    };
  }, []); // Chạy lại useEffect nếu items thay đổi

  return (
    <>
      <div
        style={{
          position: "sticky",
          top: 0,
          background: "white",
          padding: "10px",
          zIndex: 1,
        }}
      >
        Active Item: {activeItem}
      </div>
      <div
        style={{
          height: "400px",
          overflow: "auto",
          display: "flex",
          flexDirection: "column",
          gap: "30px",
        }}
        ref={container}
      >
        {items.map(({ id, content }) => (
          <div
            key={id}
            id={id}
            style={{ paddingBottom: "30px", position: "relative" }}
          >
            <h1>{id}</h1>
            <p>{content}</p>
          </div>
        ))}
      </div>
    </>
  );
};

export default Demo;
